<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saral Sahayata</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Hind:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a237e;
            --primary-dark: #0d1b6b;
            --primary-light: #283593;
            --secondary-color: #d32f2f;
            --accent-color: #ff6f00;
            --background-color: #f8fafc;
            --card-background: #ffffff;
            --text-color: #202124;
            --light-text-color: #5f6368;
            --border-color: #dadce0;
            --danger-color: #ea4335;
            --success-color: #34a853;
            --warning-color: #f9ab00;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            --border-radius: 12px;
        }
        
        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hind', 'Poppins', sans-serif;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            line-height: 1.6;
        }
        
        /* Tricolor Strip */
        .tricolor-strip {
            height: 5px;
            display: flex;
            background: linear-gradient(to right, #ff9933 33%, #ffffff 33%, #ffffff 66%, #138808 66%);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* Header with Consistent Blue Background */
        .app-header {
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .app-logo {
            width: 42px;
            height: 42px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--primary-color);
            font-size: 18px;
            border: 2px solid #ff9933;
            overflow: hidden;
        }
        
        .app-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .app-name {
            font-size: 18px;
            font-weight: 700;
        }
        
        .app-tagline {
            font-size: 10px;
            opacity: 0.9;
            margin-top: -2px;
            color: rgba(255,255,255,0.8);
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .auth-button {
            padding: 8px 20px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.15);
            color: white;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .auth-button:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-1px);
        }
        
        .profile-section {
            position: relative;
            display: none;
        }
        
        .profile-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.15);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 14px;
        }
        
        .profile-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.05);
        }
        
        /* Improved Profile Dropdown */
        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            padding: 15px 0;
            min-width: 260px;
            display: none;
            margin-top: 10px;
            z-index: 1000;
            border: 1px solid var(--border-color);
            transform-origin: top right;
            animation: dropdownFadeIn 0.2s ease-out;
        }
        
        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .profile-dropdown.show {
            display: block;
        }
        
        .dropdown-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-color);
            transition: background 0.3s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 15px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .dropdown-item:hover {
            background: #f0f5ff;
        }
        
        .dropdown-item i {
            width: 18px;
            color: var(--primary-color);
            font-size: 16px;
        }
        
        .dropdown-divider {
            height: 1px;
            background: var(--border-color);
            margin: 8px 0;
        }
        
        .user-info {
            cursor: default;
            padding: 15px 20px;
            background: #f8fafc;
            border-radius: 8px;
            margin: 0 10px 10px;
        }
        
        .user-info:hover {
            background: #f8fafc !important;
        }
        
        .user-bio {
            font-size: 13px;
            color: var(--light-text-color);
            margin-top: 6px;
            line-height: 1.4;
            max-height: 40px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        /* Search Bar - Full Width */
        .search-container {
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            padding: 15px 0;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background: #f1f3f4;
            border-radius: 24px;
            padding: 8px 16px;
            transition: all 0.3s;
            border: 1px solid transparent;
            max-width: 1200px;
            margin: 0 auto;
            width: calc(100% - 40px);
        }
        
        .search-box:focus-within {
            background: white;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(26, 35, 126, 0.2);
        }
        
        .search-box i {
            color: var(--light-text-color);
            margin-right: 10px;
        }
        
        .search-input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 16px;
            font-family: 'Hind', sans-serif;
            outline: none;
        }
        
        .search-input::placeholder {
            color: var(--light-text-color);
        }
        
        /* Auth Modal Styles */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .auth-modal.active {
            display: flex;
        }
        
        .auth-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid var(--border-color);
            position: relative;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .auth-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: var(--light-text-color);
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: -2px;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: 'Hind', sans-serif;
            background: white;
        }
        
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .form-group select {
            cursor: pointer;
        }
        
        .auth-submit {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        .auth-submit:hover {
            background: var(--primary-dark);
        }
        
        .auth-switch {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--light-text-color);
        }
        
        .auth-switch a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }
        
        .close-auth {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 20px;
            color: var(--light-text-color);
            cursor: pointer;
            z-index: 1;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }
        
        .close-auth:hover {
            background: #f1f3f4;
        }
        
        /* Edit Profile Modal */
        .edit-profile-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-y: auto;
        }
        
        .edit-profile-modal.active {
            display: flex;
        }
        
        .edit-profile-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            width: 100%;
            max-width: 450px;
            margin: 20px auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            border: 1px solid var(--border-color);
        }
        
        .edit-profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .edit-profile-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-color);
            margin: 0;
        }
        
        .close-edit-profile {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--light-text-color);
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }
        
        .close-edit-profile:hover {
            background: #f1f3f4;
        }
        
        .profile-picture-section {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        
        .profile-picture {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            font-weight: 600;
            margin: 0 auto 10px;
            border: 3px solid var(--border-color);
            overflow: hidden;
        }
        
        .profile-picture img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .change-photo-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Back Button for Edit Profile */
        .back-button {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        
        .back-button:hover {
            background: #f0f5ff;
        }
        
        /* Content Pages Styles */
        .content-page {
            display: none;
            flex-grow: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px 15px;
            padding-bottom: 80px;
            background-color: var(--background-color);
        }
        
        .content-page.active {
            display: block;
        }
        
        .content-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .content-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
        }
        
        .content-body {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }
        
        .content-section {
            margin-bottom: 30px;
        }
        
        .content-section:last-child {
            margin-bottom: 0;
        }
        
        .content-section h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .content-section p {
            margin-bottom: 15px;
            line-height: 1.7;
        }
        
        .content-section ul, .content-section ol {
            margin-bottom: 15px;
            padding-left: 25px;
        }
        
        .content-section li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        /* Feedback Form Styles */
        .feedback-form {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .feedback-form .form-group {
            margin-bottom: 20px;
        }
        
        .feedback-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }
        
        .feedback-form input, .feedback-form textarea, .feedback-form select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: 'Hind', sans-serif;
            background: white;
        }
        
        .feedback-form input:focus, .feedback-form textarea:focus, .feedback-form select:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .feedback-form textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .feedback-submit {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        .feedback-submit:hover {
            background: var(--primary-dark);
        }
        
        .feedback-success {
            display: none;
            text-align: center;
            padding: 30px;
            background: #f0f9f0;
            border-radius: 8px;
            border: 1px solid var(--success-color);
            margin-top: 20px;
        }
        
        .feedback-success.show {
            display: block;
        }
        
        .feedback-success i {
            font-size: 48px;
            color: var(--success-color);
            margin-bottom: 15px;
        }
        
        .feedback-success h3 {
            font-size: 20px;
            color: var(--success-color);
            margin-bottom: 10px;
        }
        
        #app-container {
            flex-grow: 1;
            position: relative;
        }
        
        .screen {
            display: block;
            flex-grow: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px 15px;
            padding-bottom: 80px;
        }

        .home-section h1 {
            font-size: 26px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
            text-align: center;
        }
        
        .subtitle {
            font-size: 14px;
            color: var(--light-text-color);
            text-align: center;
            margin-bottom: 25px;
        }

        .category-menu {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            gap: 10px;
            padding: 5px 0 15px 0;
            margin-bottom: 10px;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-button {
            flex-shrink: 0;
            background-color: var(--card-background);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .category-button.active-cat {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* नया All Services Button Styling */
        .all-services-btn {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            border: 2px solid #1a237e;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
        }

        .all-services-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .all-services-btn:hover::before {
            left: 100%;
        }

        .category-count {
            background: rgba(255,255,255,0.3);
            border-radius: 20px;
            padding: 2px 10px;
            font-size: 11px;
            font-weight: 600;
            min-width: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        /* Category Icons */
        .category-button i {
            font-size: 14px;
            width: 16px;
        }

        .link-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 20px; 
            padding: 20px 0;
        }
        
        .link-card { 
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 6px solid var(--primary-color);
            position: relative;
            overflow: hidden;
            height: 100%;
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: var(--text-color);
        }
        
        .link-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #ff9933, #138808);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .link-card:hover::after {
            transform: scaleX(1);
        }
        
        .link-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .card-logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
            border-radius: 8px;
            margin-right: 15px;
            border: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }
        
        .card-description {
            font-size: 13px;
            color: var(--light-text-color);
            margin: 0;
        }

        .ad-card {
            background-color: #FFFDE7;
            border-left: 5px solid var(--warning-color);
            text-align: center;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-decoration: none;
            color: var(--text-color);
            box-shadow: var(--shadow);
            border-radius: var(--border-radius);
            transition: transform 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .ad-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.12);
        }
        
        .ad-card:active {
            transform: scale(0.98);
        }
        
        .ad-card-title {
            color: var(--text-color);
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .ad-card-image {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            max-height: 120px;
            object-fit: cover;
        }
        
        .ad-label-small {
            font-size: 10px;
            color: var(--warning-color);
            text-transform: uppercase;
            margin-top: 5px;
            font-weight: 600;
        }

        /* Adsterra Ad Placeholders */
        .adsterra-ad {
            background: #f9f9f9;
            border: 1px dashed #ccc;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin: 15px 0;
            color: #666;
        }
        
        .adsterra-ad-header {
            grid-column: 1 / -1;
            margin-bottom: 10px;
        }
        
        .adsterra-ad-between {
            grid-column: 1 / -1;
            margin: 10px 0;
        }

        /* Updated Toast Notification */
        #toast-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background-color: #000000;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 10000;
            font-size: 14px;
            font-weight: 500;
            max-width: 90%;
            text-align: center;
        }
        
        #toast-notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        /* Confirmation Modal */
        .confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .confirmation-modal.active {
            display: flex;
        }
        
        .confirmation-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .confirmation-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 15px;
        }
        
        .confirmation-message {
            font-size: 16px;
            color: var(--light-text-color);
            margin-bottom: 25px;
        }
        
        .confirmation-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .confirmation-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            flex: 1;
        }
        
        .confirmation-cancel {
            background: #f1f3f4;
            color: var(--text-color);
        }
        
        .confirmation-cancel:hover {
            background: #e8eaed;
        }
        
        .confirmation-confirm {
            background: var(--danger-color);
            color: white;
        }
        
        .confirmation-confirm:hover {
            background: #d33426;
        }
        
        /* Loading Spinner */
        #loading-spinner {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        #loading-spinner.show {
            display: flex;
        }
        
        .spinner-icon {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .spinner-text {
            font-size: 16px;
            color: var(--text-color);
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--light-text-color);
            grid-column: 1 / -1;
        }
        
        .empty-state i {
            font-size: 48px;
            color: var(--border-color);
            margin-bottom: 15px;
        }
        
        /* Footer */
        .app-footer {
            background: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
            margin-top: auto;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .footer-link {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }
        
        .footer-link:hover {
            color: white;
        }
        
        .copyright {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .link-grid {
                grid-template-columns: 1fr;
            }
            
            .app-name {
                font-size: 16px;
            }
            
            .app-tagline {
                font-size: 9px;
            }
            
            .header-controls {
                gap: 10px;
            }
            
            .auth-button {
                padding: 6px 15px;
                font-size: 11px;
            }
            
            .profile-btn {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            .profile-dropdown {
                min-width: 200px;
                right: -10px;
            }
            
            .auth-container, .edit-profile-container {
                padding: 20px;
                margin: 10px;
            }
            
            .edit-profile-modal {
                padding: 10px;
                align-items: flex-start;
            }
            
            .edit-profile-container {
                margin-top: 10px;
                margin-bottom: 10px;
            }
            
            .profile-picture {
                width: 70px;
                height: 70px;
                font-size: 24px;
            }
            
            .footer-links {
                gap: 15px;
            }
            
            .footer-link {
                font-size: 13px;
            }
            
            .confirmation-buttons {
                flex-direction: column;
            }
            
            .content-body {
                padding: 20px;
            }
            
            .content-title {
                font-size: 22px;
            }
        }

        @media (max-width: 480px) {
            .app-header {
                padding: 12px 15px;
            }
            
            .logo-section {
                gap: 8px;
            }
            
            .app-logo {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
            
            .app-name {
                font-size: 14px;
            }
            
            .app-tagline {
                font-size: 8px;
            }
            
            .auth-container, .edit-profile-container {
                padding: 15px;
                margin: 5px;
            }
            
            .edit-profile-header {
                margin-bottom: 15px;
            }
            
            .edit-profile-title {
                font-size: 18px;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
            
            .form-group input, .form-group textarea, .form-group select {
                padding: 10px;
                font-size: 14px;
            }
            
            .auth-submit {
                padding: 10px;
                font-size: 14px;
            }
            
            .profile-dropdown {
                min-width: 180px;
                right: -15px;
            }
            
            .user-bio {
                font-size: 11px;
                -webkit-line-clamp: 3;
                max-height: 42px;
            }
            
            .profile-picture {
                width: 60px;
                height: 60px;
                font-size: 20px;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 10px;
            }
            
            .content-body {
                padding: 15px;
            }
            
            .content-title {
                font-size: 20px;
            }
        }

        @media (max-width: 360px) {
            .auth-container, .edit-profile-container {
                padding: 12px;
            }
            
            .edit-profile-title {
                font-size: 16px;
            }
            
            .profile-picture {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .form-group input, .form-group textarea, .form-group select {
                padding: 8px;
                font-size: 13px;
            }
            
            .content-body {
                padding: 12px;
            }
        }

        /* Prevent body scroll when modal is open */
        body.modal-open {
            overflow: hidden;
        }
        
        /* Hindi Font Support */
        .hindi-text {
            font-family: 'Hind', sans-serif;
        }
        
        /* Input validation styles */
        .input-error {
            border-color: var(--danger-color) !important;
            box-shadow: 0 0 0 2px rgba(234, 67, 53, 0.2) !important;
        }
        
        .error-message {
            color: var(--danger-color);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .error-message.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Tricolor Strip -->
    <div class="tricolor-strip"></div>
    
    <!-- Header with Consistent Blue Background -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="app-logo">
                    <span>स</span>
                </div>
                <div>
                    <div class="app-name">Saral Sahayata</div>
                    <div class="app-tagline">सरकारी सेवाओं का एक मंच</div>
                </div>
            </div>
            
            <div class="header-controls">
                <!-- Single Auth Button (Visible when not logged in) -->
                <button class="auth-button" id="auth-btn">
                    <i class="fas fa-user"></i>
                    <span id="auth-btn-text">Sign Up / Log In</span>
                </button>
                
                <!-- Profile Section (Visible when logged in) -->
                <div class="profile-section" id="profile-section">
                    <button class="profile-btn" id="profile-btn">
                        <!-- Profile picture letter will be inserted here by JavaScript -->
                    </button>
                    <div class="profile-dropdown" id="profile-dropdown">
                        <div class="dropdown-item user-info">
                            <div>
                                <div id="user-name">User Name</div>
                                <div id="user-email" style="color: var(--light-text-color); font-size: 12px;">user@email.com</div>
                                <div id="user-bio" class="user-bio"></div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="edit-profile-btn">
                            <i class="fas fa-user-edit"></i>
                            <span>Edit Profile</span>
                        </button>
                        <button class="dropdown-item" id="privacy-policy-btn">
                            <i class="fas fa-shield-alt"></i>
                            <span>Privacy Policy</span>
                        </button>
                        <button class="dropdown-item" id="terms-service-btn">
                            <i class="fas fa-file-contract"></i>
                            <span>Terms & Service</span>
                        </button>
                        <!-- NEW: About Button added below Terms & Service -->
                        <button class="dropdown-item" id="about-btn">
                            <i class="fas fa-info-circle"></i>
                            <span>About</span>
                        </button>
                        <button class="dropdown-item" id="feedback-support-btn">
                            <i class="fas fa-headset"></i>
                            <span>Feedback & Support</span>
                        </button>
                        <button class="dropdown-item" id="whatsapp-channel-btn">
                            <i class="fab fa-whatsapp"></i>
                            <span>Join WhatsApp</span>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Search Bar - Full Width -->
    <div class="search-container">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" class="search-input" id="search-input" placeholder="सेवाएं खोजें...">
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="auth-modal">
        <div class="auth-container">
            <button class="close-auth" id="close-auth">&times;</button>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Log In</button>
                <button class="auth-tab" data-tab="signup">Sign Up</button>
            </div>
            
            <!-- Login Form -->
            <form class="auth-form active" id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" required placeholder="Enter your password (min. 6 characters)">
                    <div class="error-message" id="login-password-error"></div>
                </div>
                
                <button type="submit" class="auth-submit">Log In</button>
                
                <div class="auth-switch">
                    Don't have an account? <a id="switch-to-signup">Sign Up</a>
                </div>
            </form>
            
            <!-- Signup Form -->
            <form class="auth-form" id="signup-form">
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" required placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" required placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" required placeholder="Create a password (min. 6 characters)">
                    <div class="error-message" id="signup-password-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="signup-phone">Phone Number</label>
                    <input type="tel" id="signup-phone" placeholder="Enter your phone number" maxlength="10">
                    <div class="error-message" id="signup-phone-error"></div>
                </div>
                
                <button type="submit" class="auth-submit">Create Account</button>
                
                <div class="auth-switch">
                    Already have an account? <a id="switch-to-login">Log In</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="edit-profile-modal" id="edit-profile-modal">
        <div class="edit-profile-container">
            <div class="edit-profile-header">
                <button class="back-button" id="back-edit-profile">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back</span>
                </button>
                <h2 class="edit-profile-title">Edit Profile</h2>
                <button class="close-edit-profile" id="close-edit-profile">&times;</button>
            </div>
            
            <div class="profile-picture-section">
                <div class="profile-picture" id="profile-picture">
                    <span id="profile-initials">U</span>
                </div>
                <button class="change-photo-btn" id="change-photo-btn">Change Photo</button>
            </div>
            
            <form id="edit-profile-form">
                <div class="form-group">
                    <label for="edit-name">Full Name</label>
                    <input type="text" id="edit-name" required placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="edit-email">Email</label>
                    <input type="email" id="edit-email" required placeholder="Enter your email" readonly>
                </div>
                
                <div class="form-group">
                    <label for="edit-phone">Phone Number</label>
                    <input type="tel" id="edit-phone" placeholder="Enter your phone number" maxlength="10">
                    <div class="error-message" id="edit-phone-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="edit-gender">Gender</label>
                    <select id="edit-gender">
                        <option value="">Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                        <option value="prefer-not-to-say">Prefer not to say</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="edit-bio">Bio</label>
                    <textarea id="edit-bio" placeholder="Tell us about yourself (max 150 characters)" maxlength="150"></textarea>
                    <div style="text-align: right; font-size: 12px; color: var(--light-text-color); margin-top: 5px;">
                        <span id="bio-counter">0</span>/150 characters
                    </div>
                </div>
                
                <button type="submit" class="auth-submit">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="confirmation-modal" id="logout-confirmation-modal">
        <div class="confirmation-container">
            <h3 class="confirmation-title">Logout Confirmation</h3>
            <p class="confirmation-message">क्या आप वाकई लॉगआउट करना चाहते हैं?</p>
            <div class="confirmation-buttons">
                <button class="confirmation-btn confirmation-cancel" id="logout-cancel">Cancel</button>
                <button class="confirmation-btn confirmation-confirm" id="logout-confirm">Yes, Logout</button>
            </div>
        </div>
    </div>

    <!-- Content Pages -->
    <!-- Privacy Policy Page -->
    <div id="privacy-policy-page" class="content-page">
        <div class="content-header">
            <button class="back-button" id="back-privacy-policy">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            <h1 class="content-title">Privacy Policy</h1>
        </div>
        <div class="content-body" id="privacy-policy-content">
            <!-- Content will be loaded from Firebase -->
            <div class="content-section">
                <h2>Loading Privacy Policy...</h2>
                <p>Please wait while we load the privacy policy content.</p>
            </div>
        </div>
    </div>

    <!-- Terms & Service Page -->
    <div id="terms-service-page" class="content-page">
        <div class="content-header">
            <button class="back-button" id="back-terms-service">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            <h1 class="content-title">Terms & Service</h1>
        </div>
        <div class="content-body" id="terms-service-content">
            <!-- Content will be loaded from Firebase -->
            <div class="content-section">
                <h2>Loading Terms & Service...</h2>
                <p>Please wait while we load the terms and service content.</p>
            </div>
        </div>
    </div>

    <!-- About Page -->
    <div id="about-page" class="content-page">
        <div class="content-header">
            <button class="back-button" id="back-about">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            <h1 class="content-title">About Saral Sahayata</h1>
        </div>
        <div class="content-body" id="about-content">
            <!-- Content will be loaded from Firebase -->
            <div class="content-section">
                <h2>Loading About Information...</h2>
                <p>Please wait while we load the about content.</p>
            </div>
        </div>
    </div>

    <!-- Feedback & Support Page -->
    <div id="feedback-support-page" class="content-page">
        <div class="content-header">
            <button class="back-button" id="back-feedback-support">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            <h1 class="content-title">Feedback & Support</h1>
        </div>
        <div class="content-body">
            <div class="content-section">
                <h2>We Value Your Feedback</h2>
                <p>Your feedback is important to us as we continuously work to improve Saral Sahayata and provide better services to citizens. Please share your suggestions, report issues, or let us know about your experience using our platform.</p>
            </div>
            
            <div class="content-section">
                <h2>Submit Feedback</h2>
                <form id="feedback-form" class="feedback-form">
                    <div class="form-group">
                        <label for="feedback-name">Full Name</label>
                        <input type="text" id="feedback-name" required placeholder="Enter your full name">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedback-email">Email Address</label>
                        <input type="email" id="feedback-email" required placeholder="Enter your email address">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedback-phone">Phone Number (Optional)</label>
                        <input type="tel" id="feedback-phone" placeholder="Enter your phone number" maxlength="10">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedback-type">Feedback Type</label>
                        <select id="feedback-type" required>
                            <option value="">Select feedback type</option>
                            <option value="suggestion">Suggestion</option>
                            <option value="bug">Bug Report</option>
                            <option value="complaint">Complaint</option>
                            <option value="compliment">Compliment</option>
                            <option value="general">General Feedback</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedback-subject">Subject</label>
                        <input type="text" id="feedback-subject" required placeholder="Enter subject of your feedback">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedback-message">Message</label>
                        <textarea id="feedback-message" required placeholder="Please describe your feedback in detail" minlength="10"></textarea>
                    </div>
                    
                    <button type="submit" class="feedback-submit">Submit Feedback</button>
                </form>
                
                <div id="feedback-success" class="feedback-success">
                    <i class="fas fa-check-circle"></i>
                    <h3>Thank You!</h3>
                    <p>Your feedback has been submitted successfully. We appreciate your input and will review it shortly.</p>
                </div>
            </div>
            
            <div class="content-section">
               
                <p>If you need immediate assistance, you can reach us through the following channels:</p>
                <ul>
                    <li><strong>Email Support:</strong> print3486@gmail.com</li>
                    <li><strong>WhatsApp Support:</strong> +91-XXXXXXXXXX</li>
                </ul>
            </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container">
        <main>
            <div id="home-screen" class="screen">
                <div class="home-section">
                   
                    <!-- Adsterra Header Ad Placeholder -->
                    <div class="adsterra-ad adsterra-ad-header" id="header-ad">
                        <p>Advertisement Space - Adsterra Code Here</p>
                    </div>
                     
                    <div class="category-menu" id="category-menu">
                        <!-- Categories will be loaded here -->
                    </div>

                    <div class="link-grid" id="link-grid">
                        <!-- Links and ads will be loaded here -->
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    
    <!-- Loading Spinner -->
    <div id="loading-spinner">
        <i class="fas fa-spinner fa-spin spinner-icon"></i>
        <p class="spinner-text">लोड हो रहा है...</p>
    </div>

    <!-- Updated Toast Notification with Black Background -->
    <div id="toast-notification" role="alert">
        <i id="toast-icon"></i>
        <span id="toast-text"></span>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <script>
        // Fixed Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDjYYketRe_mLhPefzG1-gbcV4kxOFxJ4s",
            authDomain: "saral-sahayata.firebaseapp.com",
            databaseURL: "https://saral-sahayata-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "saral-sahayata",
            storageBucket: "saral-sahayata.appspot.com",
            messagingSenderId: "2040973139",
            appId: "1:2040973139:web:d2f0c7c5ee2fddf89583a6"
        };
        
        // Initialize Firebase
        let database, auth;
        try {
            const app = firebase.initializeApp(firebaseConfig);
            database = app.database();
            auth = app.auth();
        } catch (error) {
            console.error('Firebase initialization error:', error);
            showToast('Firebase connection failed!', 'error');
        }
        
        // Database References
        const linksRef = database ? database.ref('links') : null;
        const adsRef = database ? database.ref('ads') : null;
        const settingsRef = database ? database.ref('settings') : null;
        const usersRef = database ? database.ref('users') : null;
        const feedbackRef = database ? database.ref('feedback') : null;
        const contentRef = database ? database.ref('content') : null;
        const analyticsRef = database ? database.ref('analytics') : null;

        // Enhanced Categories with Hindi Support and Icons
        let categories = {
            'all': {
                name: 'सभी सेवाएं',
                icon: 'fas fa-th-large',
                count: 0
            },
            'job': {
                name: 'नौकरी और करियर',
                icon: 'fas fa-briefcase',
                count: 0
            },
            'student': {
                name: 'छात्र और शिक्षा',
                icon: 'fas fa-graduation-cap',
                count: 0
            },
            'utility': {
                name: 'सरकारी योजनाएं',
                icon: 'fas fa-hand-holding-heart',
                count: 0
            },
            'health': {
                name: 'स्वास्थ्य सेवाएं',
                icon: 'fas fa-heartbeat',
                count: 0
            },
            'finance': {
                name: 'वित्त और बैंकिंग',
                icon: 'fas fa-rupee-sign',
                count: 0
            },
            'agriculture': {
                name: 'कृषि सेवाएं',
                icon: 'fas fa-tractor',
                count: 0
            },
            'travel': {
                name: 'यात्रा और परिवहन',
                icon: 'fas fa-bus',
                count: 0
            },
            'legal': {
                name: 'कानूनी सेवाएं',
                icon: 'fas fa-gavel',
                count: 0
            }
        };
        
        let currentCategory = 'all';
        let adFrequency = 3;
        let currentUser = null;
        let userData = null;
        let allLinks = {};
        let allAds = {};
        let filteredLinks = [];
        let searchTimeout;

        // DOM Elements
        const linkGrid = document.getElementById('link-grid');
        const categoryMenu = document.getElementById('category-menu');
        const searchInput = document.getElementById('search-input');
        const toast = document.getElementById('toast-notification');
        const toastText = document.getElementById('toast-text');
        const toastIcon = document.getElementById('toast-icon');
        const loadingSpinner = document.getElementById('loading-spinner');
        
        // Logout Confirmation Modal Elements
        const logoutConfirmationModal = document.getElementById('logout-confirmation-modal');
        const logoutCancelBtn = document.getElementById('logout-cancel');
        const logoutConfirmBtn = document.getElementById('logout-confirm');

        // Auth elements
        const authBtn = document.getElementById('auth-btn');
        const profileSection = document.getElementById('profile-section');
        const profileBtn = document.getElementById('profile-btn');
        const profileDropdown = document.getElementById('profile-dropdown');
        const userName = document.getElementById('user-name');
        const userEmail = document.getElementById('user-email');
        const userBio = document.getElementById('user-bio');

        // Modal elements
        const authModal = document.getElementById('auth-modal');
        const closeAuth = document.getElementById('close-auth');
        const authTabs = document.querySelectorAll('.auth-tab');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const switchToSignup = document.getElementById('switch-to-signup');
        const switchToLogin = document.getElementById('switch-to-login');

        // Edit Profile elements
        const editProfileBtn = document.getElementById('edit-profile-btn');
        const privacyPolicyBtn = document.getElementById('privacy-policy-btn');
        const termsServiceBtn = document.getElementById('terms-service-btn');
        const aboutBtn = document.getElementById('about-btn');
        const feedbackSupportBtn = document.getElementById('feedback-support-btn');
        const whatsappChannelBtn = document.getElementById('whatsapp-channel-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const editProfileModal = document.getElementById('edit-profile-modal');
        const closeEditProfile = document.getElementById('close-edit-profile');
        const backEditProfile = document.getElementById('back-edit-profile');
        const editProfileForm = document.getElementById('edit-profile-form');
        const profilePicture = document.getElementById('profile-picture');
        const profileInitials = document.getElementById('profile-initials');
        const changePhotoBtn = document.getElementById('change-photo-btn');
        const editBio = document.getElementById('edit-bio');
        const bioCounter = document.getElementById('bio-counter');
        const editGender = document.getElementById('edit-gender');

        // Content Pages Elements
        const homeScreen = document.getElementById('home-screen');
        const privacyPolicyPage = document.getElementById('privacy-policy-page');
        const termsServicePage = document.getElementById('terms-service-page');
        const aboutPage = document.getElementById('about-page');
        const feedbackSupportPage = document.getElementById('feedback-support-page');
        
        // Back buttons for content pages
        const backPrivacyPolicy = document.getElementById('back-privacy-policy');
        const backTermsService = document.getElementById('back-terms-service');
        const backAbout = document.getElementById('back-about');
        const backFeedbackSupport = document.getElementById('back-feedback-support');
        
        // Feedback form elements
        const feedbackForm = document.getElementById('feedback-form');
        const feedbackSuccess = document.getElementById('feedback-success');

        // Input validation elements
        const signupPhone = document.getElementById('signup-phone');
        const signupPhoneError = document.getElementById('signup-phone-error');
        const editPhone = document.getElementById('edit-phone');
        const editPhoneError = document.getElementById('edit-phone-error');
        const signupPassword = document.getElementById('signup-password');
        const signupPasswordError = document.getElementById('signup-password-error');
        const loginPassword = document.getElementById('login-password');
        const loginPasswordError = document.getElementById('login-password-error');

        // Show loading spinner
        function showLoading() {
            loadingSpinner.classList.add('show');
        }

        // Hide loading spinner
        function hideLoading() {
            loadingSpinner.classList.remove('show');
        }

        // Enhanced Firebase Error Handler
        function handleFirebaseError(error) {
            console.error('Firebase Error:', error);
            
            switch(error.code) {
                case 'auth/email-already-in-use':
                    return 'This email is already registered';
                case 'auth/invalid-email':
                    return 'Invalid email address';
                case 'auth/weak-password':
                    return 'Password should be at least 6 characters';
                case 'auth/user-not-found':
                    return 'No account found with this email';
                case 'auth/wrong-password':
                    return 'Incorrect password';
                case 'auth/network-request-failed':
                    return 'Network error. Please check your internet connection';
                case 'auth/too-many-requests':
                    return 'Too many attempts. Please try again later';
                default:
                    return 'An error occurred. Please try again';
            }
        }

        // Input sanitization for security
        function sanitizeInput(input) {
            if (typeof input !== 'string') return '';
            const div = document.createElement('div');
            div.textContent = input;
            return div.innerHTML;
        }

        // Check online status
        function checkOnlineStatus() {
            if (!navigator.onLine) {
                showToast('You are offline. Some features may not work.', 'warning');
            }
        }

        // Authentication State Listener - FIXED
        if (auth) {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    loadUserData(user.uid);
                    showProfileSection(user);
                    showToast('स्वागत है!', 'success');
                } else {
                    // User is signed out
                    currentUser = null;
                    userData = null;
                    showAuthButton();
                }
            });
        }

        // Load user data from database - FIXED
        function loadUserData(userId) {
            if (!usersRef) {
                showToast('Database connection failed!', 'error');
                return;
            }

            usersRef.child(userId).once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    userData = snapshot.val();
                } else {
                    // Create user data if doesn't exist
                    userData = {
                        name: currentUser.displayName || 'User',
                        email: currentUser.email,
                        createdAt: Date.now(),
                        lastLogin: Date.now()
                    };
                    usersRef.child(userId).set(userData);
                }
                updateProfileDisplay();
            }).catch((error) => {
                console.error('Error loading user data:', error);
                showToast('Failed to load user data!', 'error');
            });
        }

        // FIXED: Profile display function
        function updateProfileDisplay() {
            if (currentUser) {
                const name = currentUser.displayName || (userData ? userData.name : 'User');
                const firstLetter = getFirstLetter(name);
                
                // Update header profile button with first letter
                profileBtn.innerHTML = firstLetter;
                profileBtn.style.display = 'flex';
                profileBtn.style.alignItems = 'center';
                profileBtn.style.justifyContent = 'center';
                profileBtn.style.fontWeight = '600';
                profileBtn.style.fontSize = '14px';
                
                // Update profile picture in modal with first letter
                profileInitials.textContent = firstLetter;
                
                // Update header dropdown
                userName.textContent = name;
                userEmail.textContent = currentUser.email || 'No email';
                
                // Update bio in dropdown
                if (userData && userData.bio) {
                    userBio.textContent = userData.bio;
                    userBio.style.display = 'block';
                } else {
                    userBio.style.display = 'none';
                }
                
                // Update edit profile form
                updateEditProfileForm();
            }
        }

        function updateEditProfileForm() {
            if (!currentUser) return;
            
            const name = currentUser.displayName || (userData ? userData.name : '');
            const email = currentUser.email || '';
            const phone = userData ? userData.phone || '' : '';
            const gender = userData ? userData.gender || '' : '';
            const bio = userData ? userData.bio || '' : '';
            
            document.getElementById('edit-name').value = name;
            document.getElementById('edit-email').value = email;
            document.getElementById('edit-phone').value = phone;
            document.getElementById('edit-gender').value = gender;
            document.getElementById('edit-bio').value = bio;
            bioCounter.textContent = bio.length;
        }

        function getFirstLetter(name) {
            if (!name || name.trim().length === 0) return 'U';
            return name.trim().charAt(0).toUpperCase();
        }

        function showProfileSection(user) {
            authBtn.style.display = 'none';
            profileSection.style.display = 'block';
            updateProfileDisplay();
        }

        function showAuthButton() {
            authBtn.style.display = 'flex';
            profileSection.style.display = 'none';
        }

        // Page Navigation Functions - FIXED
        function showHomePage() {
            hideAllPages();
            homeScreen.style.display = 'block';
        }

        function showPrivacyPolicyPage() {
            hideAllPages();
            privacyPolicyPage.style.display = 'block';
        }

        function showTermsServicePage() {
            hideAllPages();
            termsServicePage.style.display = 'block';
        }

        function showAboutPage() {
            hideAllPages();
            aboutPage.style.display = 'block';
        }

        function showFeedbackSupportPage() {
            hideAllPages();
            feedbackSupportPage.style.display = 'block';
        }

        function hideAllPages() {
            const pages = [
                homeScreen, 
                privacyPolicyPage, 
                termsServicePage, 
                aboutPage, 
                feedbackSupportPage
            ];
            
            pages.forEach(page => {
                if (page) {
                    page.style.display = 'none';
                }
            });
        }

        // Modal Management Functions
        function openAuthModal() {
            authModal.classList.add('active');
            document.body.classList.add('modal-open');
        }

        function closeAuthModal() {
            authModal.classList.remove('active');
            document.body.classList.remove('modal-open');
            loginForm.reset();
            signupForm.reset();
            clearValidationErrors();
        }

        function openEditProfileModal() {
            editProfileModal.classList.add('active');
            document.body.classList.add('modal-open');
            profileDropdown.classList.remove('show');
        }

        function closeEditProfileModal() {
            editProfileModal.classList.remove('active');
            document.body.classList.remove('modal-open');
            clearValidationErrors();
        }

        function openLogoutConfirmation() {
            logoutConfirmationModal.classList.add('active');
            document.body.classList.add('modal-open');
            profileDropdown.classList.remove('show');
        }

        function closeLogoutConfirmation() {
            logoutConfirmationModal.classList.remove('active');
            document.body.classList.remove('modal-open');
        }

        function switchAuthTab(tabName) {
            authTabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                }
            });
            
            loginForm.classList.remove('active');
            signupForm.classList.remove('active');
            document.getElementById(`${tabName}-form`).classList.add('active');
            clearValidationErrors();
        }

        // Input Validation Functions - FIXED
        function validatePhoneNumber(phone) {
            if (!phone || phone.trim() === '') return true; // Phone is optional
            const phoneRegex = /^[6-9]\d{9}$/; // Indian mobile numbers
            return phoneRegex.test(phone);
        }

        function validatePassword(password) {
            return password.length >= 6;
        }

        function showError(inputElement, errorElement, message) {
            if (inputElement && errorElement) {
                inputElement.classList.add('input-error');
                errorElement.textContent = message;
                errorElement.classList.add('show');
            }
        }

        function hideError(inputElement, errorElement) {
            if (inputElement && errorElement) {
                inputElement.classList.remove('input-error');
                errorElement.classList.remove('show');
            }
        }

        function clearValidationErrors() {
            // Clear all validation errors
            document.querySelectorAll('.input-error').forEach(el => {
                el.classList.remove('input-error');
            });
            document.querySelectorAll('.error-message').forEach(el => {
                el.classList.remove('show');
            });
        }

        // Event Listeners for Input Validation
        if (signupPhone) {
            signupPhone.addEventListener('input', (e) => {
                const phone = e.target.value;
                if (phone && !validatePhoneNumber(phone)) {
                    showError(signupPhone, signupPhoneError, 'Please enter a valid 10-digit Indian phone number');
                } else {
                    hideError(signupPhone, signupPhoneError);
                }
            });
        }

        if (editPhone) {
            editPhone.addEventListener('input', (e) => {
                const phone = e.target.value;
                if (phone && !validatePhoneNumber(phone)) {
                    showError(editPhone, editPhoneError, 'Please enter a valid 10-digit Indian phone number');
                } else {
                    hideError(editPhone, editPhoneError);
                }
            });
        }

        if (signupPassword) {
            signupPassword.addEventListener('input', (e) => {
                const password = e.target.value;
                if (password && !validatePassword(password)) {
                    showError(signupPassword, signupPasswordError, 'Password must be at least 6 characters');
                } else {
                    hideError(signupPassword, signupPasswordError);
                }
            });
        }

        if (loginPassword) {
            loginPassword.addEventListener('input', (e) => {
                const password = e.target.value;
                if (password && !validatePassword(password)) {
                    showError(loginPassword, loginPasswordError, 'Password must be at least 6 characters');
                } else {
                    hideError(loginPassword, loginPasswordError);
                }
            });
        }

        // Event Listeners
        authBtn.addEventListener('click', () => {
            openAuthModal();
            switchAuthTab('login');
        });

        closeAuth.addEventListener('click', closeAuthModal);

        authModal.addEventListener('click', (e) => {
            if (e.target === authModal) {
                closeAuthModal();
            }
        });

        editProfileModal.addEventListener('click', (e) => {
            if (e.target === editProfileModal) {
                closeEditProfileModal();
            }
        });

        logoutConfirmationModal.addEventListener('click', (e) => {
            if (e.target === logoutConfirmationModal) {
                closeLogoutConfirmation();
            }
        });

        authTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                switchAuthTab(tab.dataset.tab);
            });
        });

        switchToSignup.addEventListener('click', (e) => {
            e.preventDefault();
            switchAuthTab('signup');
        });

        switchToLogin.addEventListener('click', (e) => {
            e.preventDefault();
            switchAuthTab('login');
        });

        // Dropdown Button Events
        editProfileBtn.addEventListener('click', () => {
            openEditProfileModal();
            profileDropdown.classList.remove('show');
        });

        privacyPolicyBtn.addEventListener('click', () => {
            showPrivacyPolicyPage();
            profileDropdown.classList.remove('show');
        });

        termsServiceBtn.addEventListener('click', () => {
            showTermsServicePage();
            profileDropdown.classList.remove('show');
        });

        aboutBtn.addEventListener('click', () => {
            showAboutPage();
            profileDropdown.classList.remove('show');
        });

        feedbackSupportBtn.addEventListener('click', () => {
            showFeedbackSupportPage();
            profileDropdown.classList.remove('show');
        });

        whatsappChannelBtn.addEventListener('click', () => {
            window.open('https://whatsapp.com/channel/0029VaExample', '_blank');
            showToast('WhatsApp Channel opened!', 'success');
            profileDropdown.classList.remove('show');
        });

        // Logout functionality with confirmation
        logoutBtn.addEventListener('click', () => {
            openLogoutConfirmation();
        });

        logoutCancelBtn.addEventListener('click', () => {
            closeLogoutConfirmation();
        });

        logoutConfirmBtn.addEventListener('click', () => {
            if (auth) {
                auth.signOut()
                    .then(() => {
                        closeLogoutConfirmation();
                        showToast('Logged out successfully!', 'success');
                    })
                    .catch((error) => {
                        closeLogoutConfirmation();
                        showToast('Logout failed!', 'error');
                    });
            } else {
                showToast('Authentication not available!', 'error');
            }
        });

        // Back button for edit profile
        backEditProfile.addEventListener('click', () => {
            closeEditProfileModal();
        });

        // Back buttons for content pages
        backPrivacyPolicy.addEventListener('click', () => {
            showHomePage();
        });

        backTermsService.addEventListener('click', () => {
            showHomePage();
        });

        backAbout.addEventListener('click', () => {
            showHomePage();
        });

        backFeedbackSupport.addEventListener('click', () => {
            showHomePage();
        });

        changePhotoBtn.addEventListener('click', (e) => {
            e.preventDefault();
            showToast('Photo change feature coming soon!', 'info');
        });

        // Bio character counter
        editBio.addEventListener('input', (e) => {
            const length = e.target.value.length;
            bioCounter.textContent = length;
            
            if (length > 140) {
                bioCounter.style.color = 'var(--danger-color)';
            } else if (length > 120) {
                bioCounter.style.color = 'var(--warning-color)';
            } else {
                bioCounter.style.color = 'var(--light-text-color)';
            }
        });

        // Edit Profile Form Submission - FIXED
        editProfileForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!currentUser) {
                showToast('Please login to edit profile', 'error');
                return;
            }
            
            const name = sanitizeInput(document.getElementById('edit-name').value);
            const phone = document.getElementById('edit-phone').value;
            const gender = document.getElementById('edit-gender').value;
            const bio = sanitizeInput(document.getElementById('edit-bio').value);
            
            // Validate phone number
            if (phone && !validatePhoneNumber(phone)) {
                showError(editPhone, editPhoneError, 'Please enter a valid 10-digit Indian phone number');
                return;
            }
            
            showLoading();
            
            // Update user data
            const updatedData = {
                name: name,
                phone: phone,
                gender: gender,
                bio: bio,
                updatedAt: Date.now()
            };
            
            if (usersRef) {
                // Update in Firebase
                usersRef.child(currentUser.uid).update(updatedData)
                    .then(() => {
                        // Update Firebase Auth display name
                        return currentUser.updateProfile({
                            displayName: name
                        });
                    })
                    .then(() => {
                        userData = { ...userData, ...updatedData };
                        closeEditProfileModal();
                        showToast('Profile saved successfully!', 'success');
                        updateProfileDisplay();
                        hideLoading();
                    })
                    .catch((error) => {
                        hideLoading();
                        showToast('Failed to save profile!', 'error');
                    });
            } else {
                showToast('Database connection failed!', 'error');
                hideLoading();
            }
        });

        // Login Form Submission - FIXED
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Validate password
            if (!validatePassword(password)) {
                showError(loginPassword, loginPasswordError, 'Password must be at least 6 characters');
                return;
            }
            
            showLoading();
            
            if (auth) {
                auth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        closeAuthModal();
                        showToast('Login successful!', 'success');
                        hideLoading();
                    })
                    .catch((error) => {
                        const errorMessage = handleFirebaseError(error);
                        showToast(errorMessage, 'error');
                        hideLoading();
                    });
            } else {
                showToast('Authentication not available!', 'error');
                hideLoading();
            }
        });

        // Signup Form Submission - FIXED
        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = sanitizeInput(document.getElementById('signup-name').value);
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const phone = document.getElementById('signup-phone').value;
            
            // Validate password
            if (!validatePassword(password)) {
                showError(signupPassword, signupPasswordError, 'Password must be at least 6 characters');
                return;
            }
            
            // Validate phone number if provided
            if (phone && !validatePhoneNumber(phone)) {
                showError(signupPhone, signupPhoneError, 'Please enter a valid 10-digit Indian phone number');
                return;
            }
            
            showLoading();
            
            if (auth) {
                auth.createUserWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        return userCredential.user.updateProfile({
                            displayName: name
                        }).then(() => {
                            return usersRef.child(userCredential.user.uid).set({
                                name: name,
                                email: email,
                                phone: phone,
                                createdAt: Date.now(),
                                lastLogin: Date.now()
                            });
                        });
                    })
                    .then(() => {
                        closeAuthModal();
                        showToast('Account created successfully!', 'success');
                        hideLoading();
                    })
                    .catch((error) => {
                        const errorMessage = handleFirebaseError(error);
                        showToast(errorMessage, 'error');
                        hideLoading();
                    });
            } else {
                showToast('Authentication not available!', 'error');
                hideLoading();
            }
        });

        // Feedback Form Submission - FIXED
        feedbackForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = sanitizeInput(document.getElementById('feedback-name').value);
            const email = document.getElementById('feedback-email').value;
            const phone = document.getElementById('feedback-phone').value;
            const type = document.getElementById('feedback-type').value;
            const subject = sanitizeInput(document.getElementById('feedback-subject').value);
            const message = sanitizeInput(document.getElementById('feedback-message').value);
            
            // Validate phone number if provided
            if (phone && !validatePhoneNumber(phone)) {
                showToast('Please enter a valid 10-digit Indian phone number', 'error');
                return;
            }
            
            showLoading();
            
            // Save feedback
            const feedbackData = {
                name: name,
                email: email,
                phone: phone || '',
                type: type,
                subject: subject,
                message: message,
                timestamp: Date.now(),
                userId: currentUser ? currentUser.uid : 'anonymous'
            };
            
            if (feedbackRef) {
                feedbackRef.push(feedbackData)
                    .then(() => {
                        hideLoading();
                        feedbackForm.reset();
                        feedbackSuccess.classList.add('show');
                        setTimeout(() => {
                            feedbackSuccess.classList.remove('show');
                        }, 5000);
                        showToast('Feedback submitted successfully!', 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showToast('Failed to submit feedback!', 'error');
                    });
            } else {
                showToast('Database connection failed!', 'error');
                hideLoading();
            }
        });

        // Profile Dropdown Toggle
        profileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
            profileDropdown.classList.remove('show');
        });

        // Search Functionality with Debouncing
        searchInput.addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const searchTerm = e.target.value.toLowerCase();
                filterLinks(currentCategory, searchTerm);
            }, 300);
        });

        // NEW: Enhanced Category Functions
        function renderCategories() {
            categoryMenu.innerHTML = '';
            
            Object.keys(categories).forEach(key => {
                const category = categories[key];
                const button = document.createElement('button');
                button.className = `category-button ${key === 'all' ? 'all-services-btn' : ''}`;
                button.innerHTML = `
                    <i class="${category.icon}"></i>
                    <span>${category.name}</span>
                    ${key === 'all' ? `<span class="category-count" id="${key}-count">${category.count}</span>` : ''}
                `;
                button.dataset.category = key;
                
                if (key === currentCategory) {
                    button.classList.add('active-cat');
                }
                
                button.addEventListener('click', () => {
                    switchCategory(key);
                });
                
                categoryMenu.appendChild(button);
            });
        }

        // NEW: Switch Category Function
        function switchCategory(category) {
            currentCategory = category;
            
            // Update active state
            document.querySelectorAll('.category-button').forEach(btn => {
                btn.classList.remove('active-cat');
            });
            
            document.querySelector(`[data-category="${category}"]`).classList.add('active-cat');
            
            // Filter and show links
            filterLinks(category, searchInput.value);
            
            // Add animation effect
            const linkGrid = document.getElementById('link-grid');
            linkGrid.style.opacity = '0.7';
            setTimeout(() => {
                linkGrid.style.opacity = '1';
            }, 300);
        }

        // NEW: Update Category Counts
        function updateCategoryCounts() {
            // All services count
            categories.all.count = Object.keys(allLinks).filter(key => 
                allLinks[key].active !== false
            ).length;
            
            // Other categories count
            Object.keys(categories).forEach(catKey => {
                if (catKey !== 'all') {
                    categories[catKey].count = Object.keys(allLinks).filter(key => 
                        allLinks[key].category === catKey && allLinks[key].active !== false
                    ).length;
                }
            });
            
            // Update UI
            Object.keys(categories).forEach(catKey => {
                const countElement = document.getElementById(`${catKey}-count`);
                if (countElement) {
                    countElement.textContent = categories[catKey].count;
                }
            });
        }

        function filterLinks(category, searchTerm = '') {
            currentCategory = category;
            document.querySelectorAll('.category-button').forEach(btn => {
                btn.classList.remove('active-cat');
                if (btn.dataset.category === category) {
                    btn.classList.add('active-cat');
                }
            });
            
            // Filter links based on category and search term
            filteredLinks = Object.keys(allLinks)
                .map(key => ({ ...allLinks[key], key }))
                .filter(link => {
                    const categoryMatch = currentCategory === 'all' || link.category === currentCategory;
                    const searchMatch = !searchTerm || 
                        link.title.toLowerCase().includes(searchTerm) ||
                        (link.description && link.description.toLowerCase().includes(searchTerm));
                    return link.active !== false && categoryMatch && searchMatch;
                })
                .sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
            
            updateCategoryCounts();
            renderCards();
        }

        // Load settings and data - ONLY FROM FIREBASE
        function fetchLinksAndAds() {
            showLoading();
            
            if (!linksRef || !adsRef) {
                showToast('Database connection failed!', 'error');
                hideLoading();
                return;
            }

            // Load links from Firebase
            linksRef.on('value', (snapshot) => {
                allLinks = snapshot.val() || {};
                filterLinks(currentCategory, searchInput.value);
                hideLoading();
            }, (error) => {
                console.error('Error loading links:', error);
                showToast('Failed to load links!', 'error');
                hideLoading();
            });

            // Load ads from Firebase
            adsRef.on('value', (snapshot) => {
                allAds = snapshot.val() || {};
                renderCards();
            }, (error) => {
                console.error('Error loading ads:', error);
                showToast('Failed to load ads!', 'error');
            });

            // Load settings
            if (settingsRef) {
                settingsRef.on('value', (snapshot) => {
                    const settings = snapshot.val();
                    if (settings && settings.adFrequency) {
                        adFrequency = settings.adFrequency;
                    }
                });
            }

            // Load content from Firebase
            if (contentRef) {
                contentRef.on('value', (snapshot) => {
                    const content = snapshot.val() || {};
                    
                    // Update Privacy Policy
                    if (content.privacy) {
                        document.getElementById('privacy-policy-content').innerHTML = content.privacy;
                    } else {
                        document.getElementById('privacy-policy-content').innerHTML = `
                            <div class="content-section">
                                <h2>No Privacy Policy Available</h2>
                                <p>Privacy policy content will be loaded from Firebase when available.</p>
                            </div>
                        `;
                    }
                    
                    // Update Terms & Service
                    if (content.terms) {
                        document.getElementById('terms-service-content').innerHTML = content.terms;
                    } else {
                        document.getElementById('terms-service-content').innerHTML = `
                            <div class="content-section">
                                <h2>No Terms & Service Available</h2>
                                <p>Terms and service content will be loaded from Firebase when available.</p>
                            </div>
                        `;
                    }
                    
                    // Update About
                    if (content.about) {
                        document.getElementById('about-content').innerHTML = content.about;
                    } else {
                        document.getElementById('about-content').innerHTML = `
                            <div class="content-section">
                                <h2>No About Information Available</h2>
                                <p>About content will be loaded from Firebase when available.</p>
                            </div>
                        `;
                    }
                });
            }
        }

        function renderCards() {
            if (!linkGrid) return;
            
            linkGrid.innerHTML = '';
            
            const adsArray = Object.keys(allAds)
                .map(key => ({ ...allAds[key], key }))
                .filter(ad => ad.active !== false);

            if (filteredLinks.length === 0 && adsArray.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.className = 'empty-state';
                emptyMessage.innerHTML = `
                    <i class="fas fa-inbox"></i>
                    <p>No links available for this category</p>
                    <p style="font-size: 12px; margin-top: 10px;">Add links through the admin panel</p>
                `;
                linkGrid.appendChild(emptyMessage);
                return;
            }

            let linkCount = 0;
            let adIndex = 0;

            filteredLinks.forEach((link) => {
                const linkCard = createLinkCard(link);
                linkGrid.appendChild(linkCard);
                linkCount++;

                // Insert ad after every adFrequency links
                if (linkCount % adFrequency === 0 && adsArray.length > 0) {
                    const ad = adsArray[adIndex % adsArray.length];
                    const adCard = createAdCard(ad);
                    linkGrid.appendChild(adCard);
                    adIndex++;
                }
            });
            
            // Add footer ad if there are links
            if (filteredLinks.length > 0 && adsArray.length > 0) {
                const footerAd = document.createElement('div');
                footerAd.className = 'adsterra-ad adsterra-ad-between';
                footerAd.innerHTML = '<p>Advertisement Space - Adsterra Code Here</p>';
                linkGrid.appendChild(footerAd);
            }
        }

        function createLinkCard(data) {
            const card = document.createElement('a');
            card.href = data.url;
            card.target = "_blank";
            card.className = 'link-card';
            card.dataset.key = data.key;
            card.rel = "noopener noreferrer";
            
            const cardContent = document.createElement('div');
            cardContent.innerHTML = `
                <div class="card-header">
                    <img src="${data.logoUrl || 'https://via.placeholder.com/40x40/1a237e/ffffff?text=Gov'}" 
                         alt="Logo" class="card-logo">
                    <div>
                        <h3 class="card-title">${data.title}</h3>
                    </div>
                </div>
                <p class="card-description">${data.description}</p>
            `;
            card.appendChild(cardContent);
            
            // Track click analytics
            card.addEventListener('click', () => {
                if (currentUser && analyticsRef) {
                    analyticsRef.child('clicks/' + data.key).push({
                        userId: currentUser.uid,
                        timestamp: Date.now()
                    });
                }
            });
            
            return card;
        }

        function createAdCard(data) {
            const adCard = document.createElement('div');
            adCard.className = 'ad-card';
            adCard.innerHTML = data.code || `
                <p class="ad-card-title">${data.title}</p>
                <img src="${data.imageUrl || 'https://via.placeholder.com/250x80/ff6f00/ffffff?text=ADVERTISEMENT'}" 
                     alt="${data.title}" class="ad-card-image">
                <p class="ad-label-small">(Advertisement)</p>
            `;
            
            // Track ad views
            if (currentUser && analyticsRef) {
                analyticsRef.child('views/' + data.key).push({
                    userId: currentUser.uid,
                    timestamp: Date.now()
                });
            }
            
            return adCard;
        }

        // Toast Function with Black Background
        function showToast(message, type = 'info') {
            if (!toast || !toastText || !toastIcon) return;
            
            toastText.textContent = message;
            
            if (type === 'success') {
                toastIcon.className = 'fas fa-check-circle';
            } else if (type === 'error') {
                toastIcon.className = 'fas fa-exclamation-circle';
            } else {
                toastIcon.className = 'fas fa-info-circle';
            }

            // Always black background
            toast.style.backgroundColor = '#000000';
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Online/Offline Event Listeners
        window.addEventListener('online', () => {
            showToast('Connection restored', 'success');
            fetchLinksAndAds(); // Reload data when back online
        });

        window.addEventListener('offline', () => {
            showToast('You are offline', 'warning');
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderCategories();
            checkOnlineStatus();
            showHomePage();
            fetchLinksAndAds(); // Load data from Firebase
            showToast('Saral Sahayata में आपका स्वागत है!', 'success');
        });
    </script>
</body>
</html>
